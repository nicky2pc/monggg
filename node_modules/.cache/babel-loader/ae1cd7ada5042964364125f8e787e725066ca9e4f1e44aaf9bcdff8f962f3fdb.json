{"ast":null,"code":"import{CONFIG}from'../config.ts';import{Bullet}from'./Bullet.ts';export class Mondalak{constructor(x,y,isPlayer){let bulletSpeed=arguments.length>3&&arguments[3]!==undefined?arguments[3]:CONFIG.BULLET_SPEED;let fireRate=arguments.length>4&&arguments[4]!==undefined?arguments[4]:CONFIG.FIRE_RATE;let bulletColor=arguments.length>5?arguments[5]:undefined;let type=arguments.length>6?arguments[6]:undefined;let characterImage=arguments.length>7?arguments[7]:undefined;this.x=void 0;this.y=void 0;this.angle=void 0;this.speed=void 0;this.bulletSpeed=void 0;this.lastShot=void 0;this.isPlayer=void 0;this.fireRate=void 0;this.bulletColor=void 0;this.health=void 0;this.shakeOffsetX=0;this.shakeOffsetY=0;this.maxHealth=void 0;this.barrelSize=35;this.width=70;this.height=35;this.hitboxRadius=35;this.barrelThickness=6;this.shootingAnimation=false;this.characterImage=void 0;this.isBuffed=void 0;this.type=void 0;this.x=x;this.y=y;this.angle=0;this.speed=CONFIG.PLAYER_SPEED;this.bulletSpeed=bulletSpeed;this.fireRate=fireRate;this.lastShot=0;this.isPlayer=isPlayer;this.bulletColor=bulletColor;this.health=isPlayer?4:2;this.maxHealth=this.health;this.isBuffed=false;this.type=type;this.characterImage=characterImage;if(this.type===\"fire\"){this.width=this.width+30;this.height=this.height+40;this.health=4;this.maxHealth=4;}}draw(ctx,isDead){ctx.save();if(isDead)return;ctx.translate(this.x+this.shakeOffsetX,this.y+this.shakeOffsetY);ctx.rotate(this.angle);let width=this.width;let height=this.height;if(this.isPlayer){width=70;height=35;}ctx.scale(-1,1);ctx.drawImage(this.characterImage,-30,-15,width,height);this.drawHealthBar(ctx);ctx.restore();}drawHealthBar(ctx){const barWidth=30;const barHeight=4;const hpRatio=this.health/this.maxHealth;ctx.save();const translateY=this.type===\"fire\"?65:28;ctx.translate(20,translateY);ctx.fillStyle='#333';ctx.fillRect(-barWidth/2,0,barWidth,barHeight);ctx.fillStyle=hpRatio>0.5?'#0f0':hpRatio>0.3?'#ff0':'#f00';ctx.fillRect(-barWidth/2,0,barWidth*hpRatio,barHeight);ctx.restore();}heal(){if(this.health<this.maxHealth){this.health++;}}updatePosition(newX,newY){this.x=newX;this.y=newY;}shoot(){//Only for enemies\nif(Date.now()-this.lastShot>this.fireRate){this.lastShot=Date.now();const barrelEndX=this.x+Math.cos(this.angle)*this.barrelSize;const barrelEndY=this.y+Math.sin(this.angle)*this.barrelSize;const bulletSize=this.type===\"fire\"?18:6;const bulletDamage=this.type===\"fire\"?4:1;return new Bullet(barrelEndX,barrelEndY,this.angle,this.bulletSpeed,this.bulletColor,bulletSize,this.isPlayer,bulletDamage,this.type);}return null;}takeDamage(value){this.health-=value;this.applyShake();if(this.health<=0){if(!this.isPlayer){const random=Math.floor(Math.random()*10);if(random>7){return\"drop_buff\";}return\"drop_heart\";}return\"explode\";}return false;}applyShake(){let shakeFrames=6;let lastTime=0;const shakeStep=timestamp=>{if(!lastTime||timestamp-lastTime>30){this.shakeOffsetX=(Math.random()-0.5)*4;this.shakeOffsetY=(Math.random()-0.5)*4;shakeFrames--;lastTime=timestamp;}if(shakeFrames>0){requestAnimationFrame(shakeStep);}else{this.shakeOffsetX=0;this.shakeOffsetY=0;}};requestAnimationFrame(shakeStep);}}","map":{"version":3,"names":["CONFIG","Bullet","Mondalak","constructor","x","y","isPlayer","bulletSpeed","arguments","length","undefined","BULLET_SPEED","fireRate","FIRE_RATE","bulletColor","type","characterImage","angle","speed","lastShot","health","shakeOffsetX","shakeOffsetY","maxHealth","barrelSize","width","height","hitboxRadius","barrelThickness","shootingAnimation","isBuffed","PLAYER_SPEED","draw","ctx","isDead","save","translate","rotate","scale","drawImage","drawHealthBar","restore","barWidth","barHeight","hpRatio","translateY","fillStyle","fillRect","heal","updatePosition","newX","newY","shoot","Date","now","barrelEndX","Math","cos","barrelEndY","sin","bulletSize","bulletDamage","takeDamage","value","applyShake","random","floor","shakeFrames","lastTime","shakeStep","timestamp","requestAnimationFrame"],"sources":["/home/nick/Desktop/Monagaynanimas_Neynar/src/game/classes/Mondalak.ts"],"sourcesContent":["import { CONFIG } from '../config.ts';\nimport { Bullet } from './Bullet.ts';\n\nexport class Mondalak {\n  x: number;\n  y: number;\n  angle: number;\n  speed: number;\n  bulletSpeed: number;\n  lastShot: number;\n  isPlayer: boolean;\n  fireRate: number;\n  bulletColor: string;\n  health: number;\n  shakeOffsetX: number = 0; \n  shakeOffsetY: number = 0;\n  maxHealth: number;\n  barrelSize: number = 35;\n  width: number = 70;  \n  height: number = 35;\n  hitboxRadius: number = 35;\n  barrelThickness: number = 6;\n  shootingAnimation: boolean = false;\n  characterImage: HTMLImageElement;\n  isBuffed: boolean;\n  type: string;\n  constructor(\n    x: number,\n    y: number,\n    isPlayer: boolean,\n    bulletSpeed: number = CONFIG.BULLET_SPEED,\n    fireRate: number = CONFIG.FIRE_RATE,\n    bulletColor: string,\n    type: string,\n    characterImage: HTMLImageElement,\n  ) {\n    this.x = x;\n    this.y = y;\n    this.angle = 0;\n    this.speed = CONFIG.PLAYER_SPEED;\n    this.bulletSpeed = bulletSpeed;\n    this.fireRate = fireRate;\n    this.lastShot = 0;\n    this.isPlayer = isPlayer;\n    this.bulletColor = bulletColor;\n    this.health = isPlayer ? 4 : 2; \n    this.maxHealth = this.health; \n    this.isBuffed = false;\n    this.type = type; \n    this.characterImage = characterImage;\n    if (this.type === \"fire\") {\n      this.width = this.width + 30\n      this.height = this.height + 40\n      this.health = 4\n      this.maxHealth = 4\n    }\n  }\n  draw(ctx: CanvasRenderingContext2D, isDead?: boolean) {\n    ctx.save();\n    if (isDead) return;\n\n    ctx.translate(this.x + this.shakeOffsetX, this.y + this.shakeOffsetY);\n    ctx.rotate(this.angle);\n    let width = this.width;\n    let height = this.height;\n    if (this.isPlayer) {\n      width = 70;\n      height = 35;\n    }\n\n    ctx.scale(-1, 1); \n    ctx.drawImage(this.characterImage, -30, -15, width, height);\n\n    this.drawHealthBar(ctx);\n\n    ctx.restore();\n  }\n\n  drawHealthBar(ctx: CanvasRenderingContext2D) {\n    const barWidth = 30;\n    const barHeight = 4;\n    const hpRatio = this.health / this.maxHealth;\n\n    ctx.save();\n    const translateY = this.type === \"fire\" ? 65 : 28; \n    ctx.translate(20, translateY); \n\n    ctx.fillStyle = '#333';\n    ctx.fillRect(-barWidth / 2, 0, barWidth, barHeight);\n\n    ctx.fillStyle = hpRatio > 0.5 ? '#0f0' : hpRatio > 0.3 ? '#ff0' : '#f00';\n    ctx.fillRect(-barWidth / 2, 0, barWidth * hpRatio, barHeight);\n\n    ctx.restore();\n  }\n\n  heal() {\n    if ( this.health < this.maxHealth ) {\n      this.health++\n    }\n  }\n\n  updatePosition(newX: number, newY: number) {\n    this.x = newX;\n    this.y = newY;\n  }\n\n\n  shoot(): Bullet | null {\n    //Only for enemies\n    if (Date.now() - this.lastShot > this.fireRate) {\n      this.lastShot = Date.now();\n\n      const barrelEndX = this.x + Math.cos(this.angle) * this.barrelSize;\n      const barrelEndY = this.y + Math.sin(this.angle) * this.barrelSize;\n\n      const bulletSize = this.type === \"fire\" ? 18 : 6;\n      const bulletDamage = this.type === \"fire\" ? 4 : 1;\n\n      return new Bullet(\n          barrelEndX,  \n          barrelEndY,  \n          this.angle,\n          this.bulletSpeed,\n          this.bulletColor,\n          bulletSize,\n          this.isPlayer,\n          bulletDamage,\n          this.type\n      );    }\n    return null;\n  }\n\n  takeDamage(value): boolean | string {\n    this.health -= value;\n    this.applyShake();\n\n    if (this.health <= 0) {\n      if ( !this.isPlayer ) {\n        const random = Math.floor(Math.random() * 10);\n        if ( random > 7) { \n          return \"drop_buff\";\n        }\n\n        return \"drop_heart\"\n      }\n      return \"explode\"; \n    } \n   \n    return false;\n  }\n\n  applyShake() {\n    let shakeFrames = 6;\n    let lastTime = 0;\n    \n    const shakeStep = (timestamp) => {\n      if (!lastTime || timestamp - lastTime > 30) {\n        this.shakeOffsetX = (Math.random() - 0.5) * 4;\n        this.shakeOffsetY = (Math.random() - 0.5) * 4;\n        shakeFrames--;\n        lastTime = timestamp;\n      }\n      \n      if (shakeFrames > 0) {\n        requestAnimationFrame(shakeStep);\n      } else {\n        this.shakeOffsetX = 0;\n        this.shakeOffsetY = 0;\n      }\n    };\n    \n    requestAnimationFrame(shakeStep);\n  }\n}\n"],"mappings":"AAAA,OAASA,MAAM,KAAQ,cAAc,CACrC,OAASC,MAAM,KAAQ,aAAa,CAEpC,MAAO,MAAM,CAAAC,QAAS,CAuBpBC,WAAWA,CACTC,CAAS,CACTC,CAAS,CACTC,QAAiB,CAMjB,IALA,CAAAC,WAAmB,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAGR,MAAM,CAACW,YAAY,IACzC,CAAAC,QAAgB,CAAAJ,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAGR,MAAM,CAACa,SAAS,IACnC,CAAAC,WAAmB,CAAAN,SAAA,CAAAC,MAAA,GAAAD,SAAA,IAAAE,SAAA,IACnB,CAAAK,IAAY,CAAAP,SAAA,CAAAC,MAAA,GAAAD,SAAA,IAAAE,SAAA,IACZ,CAAAM,cAAgC,CAAAR,SAAA,CAAAC,MAAA,GAAAD,SAAA,IAAAE,SAAA,MA9BlCN,CAAC,aACDC,CAAC,aACDY,KAAK,aACLC,KAAK,aACLX,WAAW,aACXY,QAAQ,aACRb,QAAQ,aACRM,QAAQ,aACRE,WAAW,aACXM,MAAM,aACNC,YAAY,CAAW,CAAC,MACxBC,YAAY,CAAW,CAAC,MACxBC,SAAS,aACTC,UAAU,CAAW,EAAE,MACvBC,KAAK,CAAW,EAAE,MAClBC,MAAM,CAAW,EAAE,MACnBC,YAAY,CAAW,EAAE,MACzBC,eAAe,CAAW,CAAC,MAC3BC,iBAAiB,CAAY,KAAK,MAClCb,cAAc,aACdc,QAAQ,aACRf,IAAI,QAWF,IAAI,CAACX,CAAC,CAAGA,CAAC,CACV,IAAI,CAACC,CAAC,CAAGA,CAAC,CACV,IAAI,CAACY,KAAK,CAAG,CAAC,CACd,IAAI,CAACC,KAAK,CAAGlB,MAAM,CAAC+B,YAAY,CAChC,IAAI,CAACxB,WAAW,CAAGA,WAAW,CAC9B,IAAI,CAACK,QAAQ,CAAGA,QAAQ,CACxB,IAAI,CAACO,QAAQ,CAAG,CAAC,CACjB,IAAI,CAACb,QAAQ,CAAGA,QAAQ,CACxB,IAAI,CAACQ,WAAW,CAAGA,WAAW,CAC9B,IAAI,CAACM,MAAM,CAAGd,QAAQ,CAAG,CAAC,CAAG,CAAC,CAC9B,IAAI,CAACiB,SAAS,CAAG,IAAI,CAACH,MAAM,CAC5B,IAAI,CAACU,QAAQ,CAAG,KAAK,CACrB,IAAI,CAACf,IAAI,CAAGA,IAAI,CAChB,IAAI,CAACC,cAAc,CAAGA,cAAc,CACpC,GAAI,IAAI,CAACD,IAAI,GAAK,MAAM,CAAE,CACxB,IAAI,CAACU,KAAK,CAAG,IAAI,CAACA,KAAK,CAAG,EAAE,CAC5B,IAAI,CAACC,MAAM,CAAG,IAAI,CAACA,MAAM,CAAG,EAAE,CAC9B,IAAI,CAACN,MAAM,CAAG,CAAC,CACf,IAAI,CAACG,SAAS,CAAG,CAAC,CACpB,CACF,CACAS,IAAIA,CAACC,GAA6B,CAAEC,MAAgB,CAAE,CACpDD,GAAG,CAACE,IAAI,CAAC,CAAC,CACV,GAAID,MAAM,CAAE,OAEZD,GAAG,CAACG,SAAS,CAAC,IAAI,CAAChC,CAAC,CAAG,IAAI,CAACiB,YAAY,CAAE,IAAI,CAAChB,CAAC,CAAG,IAAI,CAACiB,YAAY,CAAC,CACrEW,GAAG,CAACI,MAAM,CAAC,IAAI,CAACpB,KAAK,CAAC,CACtB,GAAI,CAAAQ,KAAK,CAAG,IAAI,CAACA,KAAK,CACtB,GAAI,CAAAC,MAAM,CAAG,IAAI,CAACA,MAAM,CACxB,GAAI,IAAI,CAACpB,QAAQ,CAAE,CACjBmB,KAAK,CAAG,EAAE,CACVC,MAAM,CAAG,EAAE,CACb,CAEAO,GAAG,CAACK,KAAK,CAAC,CAAC,CAAC,CAAE,CAAC,CAAC,CAChBL,GAAG,CAACM,SAAS,CAAC,IAAI,CAACvB,cAAc,CAAE,CAAC,EAAE,CAAE,CAAC,EAAE,CAAES,KAAK,CAAEC,MAAM,CAAC,CAE3D,IAAI,CAACc,aAAa,CAACP,GAAG,CAAC,CAEvBA,GAAG,CAACQ,OAAO,CAAC,CAAC,CACf,CAEAD,aAAaA,CAACP,GAA6B,CAAE,CAC3C,KAAM,CAAAS,QAAQ,CAAG,EAAE,CACnB,KAAM,CAAAC,SAAS,CAAG,CAAC,CACnB,KAAM,CAAAC,OAAO,CAAG,IAAI,CAACxB,MAAM,CAAG,IAAI,CAACG,SAAS,CAE5CU,GAAG,CAACE,IAAI,CAAC,CAAC,CACV,KAAM,CAAAU,UAAU,CAAG,IAAI,CAAC9B,IAAI,GAAK,MAAM,CAAG,EAAE,CAAG,EAAE,CACjDkB,GAAG,CAACG,SAAS,CAAC,EAAE,CAAES,UAAU,CAAC,CAE7BZ,GAAG,CAACa,SAAS,CAAG,MAAM,CACtBb,GAAG,CAACc,QAAQ,CAAC,CAACL,QAAQ,CAAG,CAAC,CAAE,CAAC,CAAEA,QAAQ,CAAEC,SAAS,CAAC,CAEnDV,GAAG,CAACa,SAAS,CAAGF,OAAO,CAAG,GAAG,CAAG,MAAM,CAAGA,OAAO,CAAG,GAAG,CAAG,MAAM,CAAG,MAAM,CACxEX,GAAG,CAACc,QAAQ,CAAC,CAACL,QAAQ,CAAG,CAAC,CAAE,CAAC,CAAEA,QAAQ,CAAGE,OAAO,CAAED,SAAS,CAAC,CAE7DV,GAAG,CAACQ,OAAO,CAAC,CAAC,CACf,CAEAO,IAAIA,CAAA,CAAG,CACL,GAAK,IAAI,CAAC5B,MAAM,CAAG,IAAI,CAACG,SAAS,CAAG,CAClC,IAAI,CAACH,MAAM,EAAE,CACf,CACF,CAEA6B,cAAcA,CAACC,IAAY,CAAEC,IAAY,CAAE,CACzC,IAAI,CAAC/C,CAAC,CAAG8C,IAAI,CACb,IAAI,CAAC7C,CAAC,CAAG8C,IAAI,CACf,CAGAC,KAAKA,CAAA,CAAkB,CACrB;AACA,GAAIC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG,IAAI,CAACnC,QAAQ,CAAG,IAAI,CAACP,QAAQ,CAAE,CAC9C,IAAI,CAACO,QAAQ,CAAGkC,IAAI,CAACC,GAAG,CAAC,CAAC,CAE1B,KAAM,CAAAC,UAAU,CAAG,IAAI,CAACnD,CAAC,CAAGoD,IAAI,CAACC,GAAG,CAAC,IAAI,CAACxC,KAAK,CAAC,CAAG,IAAI,CAACO,UAAU,CAClE,KAAM,CAAAkC,UAAU,CAAG,IAAI,CAACrD,CAAC,CAAGmD,IAAI,CAACG,GAAG,CAAC,IAAI,CAAC1C,KAAK,CAAC,CAAG,IAAI,CAACO,UAAU,CAElE,KAAM,CAAAoC,UAAU,CAAG,IAAI,CAAC7C,IAAI,GAAK,MAAM,CAAG,EAAE,CAAG,CAAC,CAChD,KAAM,CAAA8C,YAAY,CAAG,IAAI,CAAC9C,IAAI,GAAK,MAAM,CAAG,CAAC,CAAG,CAAC,CAEjD,MAAO,IAAI,CAAAd,MAAM,CACbsD,UAAU,CACVG,UAAU,CACV,IAAI,CAACzC,KAAK,CACV,IAAI,CAACV,WAAW,CAChB,IAAI,CAACO,WAAW,CAChB8C,UAAU,CACV,IAAI,CAACtD,QAAQ,CACbuD,YAAY,CACZ,IAAI,CAAC9C,IACT,CAAC,CAAK,CACR,MAAO,KAAI,CACb,CAEA+C,UAAUA,CAACC,KAAK,CAAoB,CAClC,IAAI,CAAC3C,MAAM,EAAI2C,KAAK,CACpB,IAAI,CAACC,UAAU,CAAC,CAAC,CAEjB,GAAI,IAAI,CAAC5C,MAAM,EAAI,CAAC,CAAE,CACpB,GAAK,CAAC,IAAI,CAACd,QAAQ,CAAG,CACpB,KAAM,CAAA2D,MAAM,CAAGT,IAAI,CAACU,KAAK,CAACV,IAAI,CAACS,MAAM,CAAC,CAAC,CAAG,EAAE,CAAC,CAC7C,GAAKA,MAAM,CAAG,CAAC,CAAE,CACf,MAAO,WAAW,CACpB,CAEA,MAAO,YAAY,CACrB,CACA,MAAO,SAAS,CAClB,CAEA,MAAO,MAAK,CACd,CAEAD,UAAUA,CAAA,CAAG,CACX,GAAI,CAAAG,WAAW,CAAG,CAAC,CACnB,GAAI,CAAAC,QAAQ,CAAG,CAAC,CAEhB,KAAM,CAAAC,SAAS,CAAIC,SAAS,EAAK,CAC/B,GAAI,CAACF,QAAQ,EAAIE,SAAS,CAAGF,QAAQ,CAAG,EAAE,CAAE,CAC1C,IAAI,CAAC/C,YAAY,CAAG,CAACmC,IAAI,CAACS,MAAM,CAAC,CAAC,CAAG,GAAG,EAAI,CAAC,CAC7C,IAAI,CAAC3C,YAAY,CAAG,CAACkC,IAAI,CAACS,MAAM,CAAC,CAAC,CAAG,GAAG,EAAI,CAAC,CAC7CE,WAAW,EAAE,CACbC,QAAQ,CAAGE,SAAS,CACtB,CAEA,GAAIH,WAAW,CAAG,CAAC,CAAE,CACnBI,qBAAqB,CAACF,SAAS,CAAC,CAClC,CAAC,IAAM,CACL,IAAI,CAAChD,YAAY,CAAG,CAAC,CACrB,IAAI,CAACC,YAAY,CAAG,CAAC,CACvB,CACF,CAAC,CAEDiD,qBAAqB,CAACF,SAAS,CAAC,CAClC,CACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}