{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{CONFIG}from'../../game/config.ts';import{Mondalak}from'../../game/classes/Mondalak.ts';import{Bullet}from'../../game/classes/Bullet.ts';import{Heart}from'../../game/classes/Heart.ts';import{Buff}from'../../game/classes/Heart.ts';import createEnemy from'../../game/createEnemy.ts';import{loadSounds,playRandomSound,playSound,getLeaderBoard}from'../../game/utils.ts';import{useFrameMultiplier}from'../../providers/FrameMultiplierProvider.tsx';import{useTransactions}from'../../hooks/useTransactions.ts';import LeaderboardPopup from'../LeaderboardPopup/LeaderboardPopup.tsx';import TransactionsTable from'../TransactionsTable/TransactionsTable.tsx';import GameUI from'../GameUI/GameUI.tsx';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Game=()=>{var _canvasRef$current2,_canvasRef$current3;const canvasRef=useRef(null);const explosions=useRef([]);const enemies=useRef([]);const playerTank=useRef(null);const bullets=useRef([]);const isDead=useRef(false);const audioPool=useRef([]);const hearts=useRef([]);const buffs=useRef([]);const killCountRef=useRef(0);const totalScoreRef=useRef(0);const countdownRef=useRef(false);const isSoundOn=useRef(true);const buffTimerRef=useRef(null);const frameMultiplier=useFrameMultiplier();const{transactions,handleMint,handleTotalScore}=useTransactions();const imageCache={enemies:{},fire:{},player:{}};const imageCacheRef=useRef({enemies:{},fire:{},player:{}});const[assetsLoaded,setAssetsLoaded]=useState(false);const[gameState,setGameState]=useState('menu');const[sounds,setSounds]=useState(null);const[soundBtnLabelOn,setSoundBtnLabelOn]=useState(true);const[countdownValue,setCountdownValue]=useState(3);const[buffTimerValue,setBuffTimerValue]=useState(0);const[isStartButtonDisabled,setIsStartButtonDisabled]=useState(true);const[gameStat,setGameStat]=useState({totalScore:0,killCount:0,fireMondalakKillKount:0,damageTaken:0,damageGiven:0,healsUsed:0,buffsTaken:0});const[isLeaderboardOpen,setIsLeaderboardOpen]=useState(false);const updateGameStat=(key,value)=>{setGameStat(prev=>({...prev,[key]:typeof value===\"function\"?value(prev[key]):value}));};const[explosionFrames,setExplosionFrames]=useState([]);const[isMobile,setIsMobile]=useState(false);const bulletPoolRef=useRef([]);const isUnsupportedBrowser=()=>{const ua=navigator.userAgent.toLowerCase();return ua.includes(\"firefox\")||ua.includes(\"safari\")&&!ua.includes(\"chrome\")||ua.includes(\"edg/\")&&!ua.includes(\"chrome\")||ua.includes(\"tor\");};const startCountdown=()=>{setGameState('countdown');countdownRef.current=true;setCountdownValue(3);let counter=3;const countdownInterval=setInterval(()=>{counter--;setCountdownValue(counter);if(counter<=0){clearInterval(countdownInterval);countdownRef.current=false;setGameState('playing');}},1000);};const startBuffTimer=(number,playerTank)=>{if(!playerTank.current||gameState!==\"playing\")return;setBuffTimerValue(number);playerTank.current.isBuffed=true;if(buffTimerRef.current){clearInterval(buffTimerRef.current);}let counter=number;const buffCountDown=setInterval(()=>{counter--;setBuffTimerValue(counter);if(counter<=0){clearInterval(buffCountDown);buffTimerRef.current=null;if(playerTank.current){playerTank.current.isBuffed=false;}}},1000);buffTimerRef.current=buffCountDown;};const preloadImages=async()=>{const imageCacheEnemies={\"default\":[\"/chars/10.svg\",\"/chars/11.svg\",\"/chars/12.svg\",\"/chars/13.svg\",\"/chars/14.svg\"]};const imageCacheFire={\"fire\":[\"/chars/8.svg\"]};const imageCachePlayer={\"main\":[\"/chars/15.svg\"]};const loadImage=src=>{return new Promise(resolve=>{const img=new Image();img.src=src;img.onload=()=>resolve(img);});};const enemyImages=await Promise.all(Object.entries(imageCacheEnemies).flatMap(_ref=>{let[key,srcList]=_ref;return srcList.map(async(src,index)=>{const img=await loadImage(src);imageCache.enemies[index]=img;});}));const enemyFireImages=await Promise.all(Object.entries(imageCacheFire).flatMap(_ref2=>{let[key,srcList]=_ref2;return srcList.map(async(src,index)=>{const img=await loadImage(src);imageCache.fire[index]=img;});}));const playerImages=await Promise.all(Object.entries(imageCachePlayer).flatMap(_ref3=>{let[key,srcList]=_ref3;return srcList.map(async(src,index)=>{const img=await loadImage(src);imageCache.player[index]=img;});}));const explosionFramesArr=await Promise.all(Array.from({length:151-16+1},(_,i)=>16+i).map(async i=>{const img=await loadImage(`/explotion/frame(${i}).png`);return img;}));setExplosionFrames(explosionFramesArr);imageCacheRef.current=imageCache;};const toggleSound=()=>{setSoundBtnLabelOn(!isSoundOn.current);isSoundOn.current=!isSoundOn.current;};const resetGameObjects=()=>{playerTank.current=new Mondalak(canvasRef.current.width/2,canvasRef.current.width/2,true,CONFIG.BULLET_SPEED,CONFIG.FIRE_RATE,\"#c005c7\",\"main\",imageCacheRef.current.player[0]);bullets.current=[];hearts.current=[];buffs.current=[];buffTimerRef.current=null;updateGameStat(\"killCount\",0);updateGameStat(\"fireMondalakKillKount\",0);updateGameStat(\"damageTaken\",0);updateGameStat(\"damageGiven\",0);updateGameStat(\"totalScore\",0);updateGameStat(\"healsUsed\",0);updateGameStat(\"buffsTaken\",0);setBuffTimerValue(0);killCountRef.current=0;totalScoreRef.current=0;isDead.current=false;audioPool.current.forEach(audio=>{audio.pause();audio.currentTime=0;});audioPool.current=[];if(gameState===\"countdown\"){enemies.current=[];spawnEnemies(0);}if(bulletPoolRef.current.length===0){for(let i=0;i<50;i++){bulletPoolRef.current.push(new Bullet(0,0,0,0,'',0,false,0,''));}}};const spawnEnemies=killCount=>{if(!killCount){createEnemy(enemies.current,1,true,\"default\",frameMultiplier,imageCacheRef.current);return;}const maxEnemiesAllowed=Math.min(CONFIG.MAX_ENEMIES_BEGINNING+Math.floor(killCount/10),CONFIG.MAX_ENEMIES);if(enemies.current.length<maxEnemiesAllowed){const enemiesToSpawn=maxEnemiesAllowed-enemies.current.length;for(let i=0;i<enemiesToSpawn;i++){const spawnDelay=150+Math.random()*(430-150);setTimeout(()=>{if(enemies.current.length<maxEnemiesAllowed){const enemyType=Math.random()<0.05?\"fire\":\"default\";const difficulty=Math.min(Math.floor(killCount/10),10);const adjustedDifficulty=enemyType===\"fire\"?difficulty*10:difficulty;enemies.current=createEnemy(enemies.current,adjustedDifficulty,false,enemyType,frameMultiplier,imageCacheRef.current);}},spawnDelay);}}};const handleStopGame=()=>{const totalScore=totalScoreRef.current;handleTotalScore(totalScore,true);setGameState(\"menu\");resetGameObjects();};useEffect(()=>{const mediaQuery=window.matchMedia(\"(max-width: 1100px)\");const handleResize=event=>{setIsMobile(event.matches);};setIsMobile(mediaQuery.matches);mediaQuery.addEventListener(\"change\",handleResize);console.log(frameMultiplier);return()=>mediaQuery.removeEventListener(\"change\",handleResize);},[]);useEffect(()=>{loadSounds().then(setSounds);preloadImages().then(()=>{setAssetsLoaded(true);});document.body.style.overflow='hidden';setTimeout(()=>{setIsStartButtonDisabled(false);document.body.style.overflow='auto';},1000);return()=>{document.body.style.overflow='auto';};},[]);useEffect(()=>{if(gameState==='playing'||gameState==='menu'){// Preload leaderboard data\ngetLeaderBoard().catch(error=>console.error('Error getting leaderboard:',error));}},[gameState]);useEffect(()=>{if(gameState===\"playing\"||gameState===\"countdown\"){if(assetsLoaded){resetGameObjects();}else{preloadImages().then(()=>{setAssetsLoaded(true);resetGameObjects();});}}else{playerTank.current=null;enemies.current=[];bullets.current=[];}},[gameState]);useEffect(()=>{if(!canvasRef.current)return;const ctx=canvasRef.current.getContext('2d');if(!ctx)return;canvasRef.current.width=CONFIG.CANVAS_WIDTH;canvasRef.current.height=CONFIG.CANVAS_HEIGHT;const keys={w:false,a:false,s:false,d:false};const mouse={x:0,y:0,shooting:false};const keyHandler=(e,isKeyDown)=>{switch(e.key.toLowerCase()){case'w':case'ц':keys.w=isKeyDown;break;case'a':case'ф':keys.a=isKeyDown;break;case's':case'ы':case\"і\":keys.s=isKeyDown;break;case'd':case'в':keys.d=isKeyDown;break;}};const getScale=()=>{const rect=canvasRef.current.getBoundingClientRect();return rect.width/CONFIG.CANVAS_WIDTH;};const mouseMoveHandler=e=>{const scale=getScale();const rect=canvasRef.current.getBoundingClientRect();mouse.x=(e.clientX-rect.left)/scale;mouse.y=(e.clientY-rect.top)/scale;};const killEnemy=(enemy,enemyIndex)=>{explosions.current.push({x:enemy.x,y:enemy.y,frame:16,width:100,height:96});enemies.current.splice(enemyIndex,1);setGameStat(prev=>{const newKillCount=prev.killCount+1;killCountRef.current=newKillCount;totalScoreRef.current=prev.totalScore+(enemy.type===\"fire\"?3:1);spawnEnemies(newKillCount);return{...prev,totalScore:prev.totalScore+(enemy.type===\"fire\"?3:1),killCount:newKillCount,fireMondalakKillKount:enemy.type===\"fire\"?prev.fireMondalakKillKount+1:prev.fireMondalakKillKount};});setTimeout(()=>{const totalScore=totalScoreRef.current;handleTotalScore(totalScore,false);},0);// if (enemy.type === \"fire\") handleMint(killCountRef.current);\naudioPool.current=playRandomSound(sounds,\"kill\",isSoundOn.current,audioPool.current);};const updateGameState=()=>{if(!playerTank.current||!canvasRef.current)return;let newX=playerTank.current.x;let newY=playerTank.current.y;if(keys.w)newY-=playerTank.current.speed*frameMultiplier;if(keys.s)newY+=playerTank.current.speed*frameMultiplier;if(keys.a)newX-=playerTank.current.speed*frameMultiplier;if(keys.d)newX+=playerTank.current.speed*frameMultiplier;newX=Math.max(45,Math.min(canvasRef.current.width-45,newX));newY=Math.max(45,Math.min(canvasRef.current.height-45,newY));playerTank.current.updatePosition(newX,newY);const dx=mouse.x-playerTank.current.x;const dy=mouse.y-playerTank.current.y;playerTank.current.angle=Math.atan2(dy,dx);if(mouse.shooting&&Date.now()-playerTank.current.lastShot>CONFIG.FIRE_RATE){const barrelEndX=playerTank.current.x+Math.cos(playerTank.current.angle)*playerTank.current.barrelSize;const barrelEndY=playerTank.current.y+Math.sin(playerTank.current.angle)*playerTank.current.barrelSize;const audioPoolNew=playSound(\"/sound/shoot/shooooot.mp3\",isSoundOn.current,audioPool.current);audioPool.current=audioPoolNew;const bullet=new Bullet(barrelEndX,barrelEndY,playerTank.current.angle,playerTank.current.bulletSpeed*frameMultiplier,playerTank.current.bulletColor,playerTank.current.isBuffed?18:7,playerTank.current.isPlayer,playerTank.current.isBuffed?2:1,\"player\");bullets.current.push(bullet);playerTank.current.lastShot=Date.now();}bullets.current=bullets.current.filter(bullet=>!bullet.isExpired);bullets.current.forEach(bullet=>bullet.update());bullets.current.forEach((bullet,bulletIndex)=>{if(playerTank.current&&!bullet.isExpired){const dx=playerTank.current.x-bullet.x;const dy=playerTank.current.y-bullet.y;if(Math.sqrt(dx*dx+dy*dy)<35){const dead=playerTank.current.takeDamage(bullet.damage);bullets.current.splice(bulletIndex,1);updateGameStat(\"damageTaken\",prev=>prev+bullet.damage);if(dead&&!isDead.current){const totalScore=totalScoreRef.current;handleTotalScore(totalScore,true);isDead.current=true;explosions.current.push({x:playerTank.current.x,y:playerTank.current.y,frame:16,width:400,height:395});playRandomSound(sounds,\"death\",isSoundOn.current,audioPool.current);setTimeout(()=>{setGameState(\"gameover\");},1000);}else{const audioPoolNew=playSound(\"/sound/applepay.mp3\",isSoundOn.current,audioPool.current);audioPool.current=audioPoolNew;}}}enemies.current.forEach((enemy,enemyIndex)=>{if(bullet.isPlayer){const dx=enemy.x-bullet.x;const dy=enemy.y-bullet.y;if(Math.sqrt(dx*dx+dy*dy)<enemy.width/2){const result=enemy.takeDamage(bullet.damage);bullets.current.splice(bulletIndex,1);updateGameStat(\"damageGiven\",prev=>prev+bullet.damage);switch(result){case\"drop_heart\":hearts.current.push(new Heart(enemy.x,enemy.y));killEnemy(enemy,enemyIndex);return;case\"drop_buff\":buffs.current.push(new Buff(enemy.x,enemy.y));killEnemy(enemy,enemyIndex);return;case false:const pool=playRandomSound(sounds,\"hit\",isSoundOn.current,audioPool.current);audioPool.current=pool;return;}}}});});hearts.current.forEach((heart,heartIndex)=>{if(playerTank.current){const dx=playerTank.current.x-heart.x;const dy=playerTank.current.y-heart.y;if(Math.sqrt(dx*dx+dy*dy)<playerTank.current.width/2&&playerTank.current.health<playerTank.current.maxHealth){hearts.current.splice(heartIndex,1);const audioPoolNew=playSound(\"/sound/heal.mp3\",isSoundOn.current,audioPool.current);audioPool.current=audioPoolNew;playerTank.current.heal();updateGameStat(\"healsUsed\",prev=>prev+1);}const expired=heart.isExpired();if(expired){hearts.current.splice(heartIndex,1);}}});buffs.current.forEach((buff,buffIndex)=>{if(playerTank.current){const dx=playerTank.current.x-buff.x;const dy=playerTank.current.y-buff.y;if(Math.sqrt(dx*dx+dy*dy)<playerTank.current.width/2){buffs.current.splice(buffIndex,1);const audioPoolNew=playSound(\"/sound/heal.mp3\",isSoundOn.current,audioPool.current);audioPool.current=audioPoolNew;playerTank.current.isBuffed=true;startBuffTimer(10,playerTank);updateGameStat(\"buffsTaken\",prev=>prev+1);}const expired=buff.isExpired();if(expired){buffs.current.splice(buffIndex,1);}}});enemies.current.forEach(enemy=>{const bullet=enemy.updateAI(playerTank.current.x,playerTank.current.y);if(bullet){bullets.current.push(bullet);}});if(killCountRef.current>10){playerTank.current.maxHealth=8;}};const gameLoop=()=>{if(!playerTank.current)return;ctx.clearRect(0,0,CONFIG.CANVAS_WIDTH,CONFIG.CANVAS_HEIGHT);ctx.fillStyle='#ffccff';ctx.fillRect(0,0,CONFIG.CANVAS_WIDTH,CONFIG.CANVAS_HEIGHT);const drawMap=ctx=>{ctx.fillStyle='#800080';for(let y=0;y<CONFIG.MAP.length;y++){for(let x=0;x<CONFIG.MAP[y].length;x++){if(CONFIG.MAP[y][x]===1){ctx.fillRect(x*CONFIG.CELL_SIZE,y*CONFIG.CELL_SIZE,CONFIG.CELL_SIZE-1,CONFIG.CELL_SIZE-1);}}}};drawMap(ctx);if(gameState===\"playing\"){updateGameState();}playerTank.current.draw(ctx,isDead.current);enemies.current.forEach(enemy=>enemy.draw(ctx));bullets.current.forEach(bullet=>bullet.draw(ctx));hearts.current.forEach(heart=>heart.draw(ctx));buffs.current.forEach(buff=>buff.drawBuff(ctx));explosions.current.forEach((explosion,index)=>{if(explosion.frame>=explosionFrames.length){explosions.current.splice(index,1);return;}ctx.drawImage(explosionFrames[explosion.frame],explosion.x-explosion.width/2+10/2,explosion.y-explosion.height/2+20/2,explosion.height,explosion.height);explosion.frame+=Math.ceil(frameMultiplier);});requestAnimationFrame(gameLoop);};window.addEventListener('keydown',e=>keyHandler(e,true));window.addEventListener('keyup',e=>keyHandler(e,false));canvasRef.current.addEventListener('mousemove',mouseMoveHandler);canvasRef.current.addEventListener('mousedown',()=>mouse.shooting=true);canvasRef.current.addEventListener('mouseup',()=>mouse.shooting=false);gameLoop();return()=>{var _canvasRef$current;window.removeEventListener('keydown',e=>keyHandler(e,true));window.removeEventListener('keyup',e=>keyHandler(e,false));(_canvasRef$current=canvasRef.current)===null||_canvasRef$current===void 0?void 0:_canvasRef$current.removeEventListener('mousemove',mouseMoveHandler);};},[gameState]);if(isUnsupportedBrowser()){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-mobile bg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mobile-warning\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Unsupported browser\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Please use browser from the list below.\"}),/*#__PURE__*/_jsxs(\"ul\",{style:{textAlign:\"left\",padding:0,margin:0},children:[/*#__PURE__*/_jsx(\"li\",{children:\"Chrome\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Edge (Chrome based)\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Safari (Chrome based)\"})]})]})});}if(isMobile){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-mobile bg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mobile-warning\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Desktop version only\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Please use a larger screen to play the game.\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"game-container\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,width:(_canvasRef$current2=canvasRef.current)===null||_canvasRef$current2===void 0?void 0:_canvasRef$current2.width,height:(_canvasRef$current3=canvasRef.current)===null||_canvasRef$current3===void 0?void 0:_canvasRef$current3.height}),gameState===\"countdown\"&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"coundown bg\",children:/*#__PURE__*/_jsx(\"h1\",{children:countdownValue})})}),/*#__PURE__*/_jsx(LeaderboardPopup,{isOpen:isLeaderboardOpen,onClose:()=>setIsLeaderboardOpen(false)}),gameState==='playing'&&/*#__PURE__*/_jsx(GameUI,{killCount:gameStat.killCount,buffTimerValue:buffTimerValue,soundBtnLabelOn:soundBtnLabelOn,onSoundToggle:toggleSound,onStopGame:handleStopGame}),gameState==='menu'&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"total-score h1\",children:[\"Kill everyone \",/*#__PURE__*/_jsx(\"br\",{}),\" Dodge everything\"]}),/*#__PURE__*/_jsx(\"button\",{disabled:isStartButtonDisabled,className:\"leaderboard-button\",onClick:()=>setIsLeaderboardOpen(true),children:\"Leaderboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"game-menu\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:isStartButtonDisabled,style:{marginRight:\"10px\"},onClick:toggleSound,children:/*#__PURE__*/_jsx(\"span\",{className:\"counter-label\",children:soundBtnLabelOn?\"Disable sounds\":\"Enable sounds\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:startCountdown,disabled:isStartButtonDisabled,children:'Start'})]})]})}),gameState==='gameover'&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"total-score h1\",children:[\"Your total score: \",gameStat.totalScore]}),/*#__PURE__*/_jsx(\"button\",{className:\"leaderboard-button\",onClick:()=>setIsLeaderboardOpen(true),children:\"Leaderboard\"}),/*#__PURE__*/_jsx(\"div\",{className:\"game-menu\",children:/*#__PURE__*/_jsx(\"button\",{onClick:startCountdown,children:'Try again'})}),/*#__PURE__*/_jsx(\"div\",{className:\"game-stat\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Total kills: \",gameStat.killCount]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Bosses killed: \",gameStat.fireMondalakKillKount]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Damage dealt: \",gameStat.damageGiven]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Damage taken: \",gameStat.damageTaken]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Heals used: \",gameStat.healsUsed]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Buffs taken: \",gameStat.buffsTaken]})]})]})})]})})]}),/*#__PURE__*/_jsx(TransactionsTable,{transactions:transactions})]});};export default Game;","map":{"version":3,"names":["React","useState","useRef","useEffect","CONFIG","Mondalak","Bullet","Heart","Buff","createEnemy","loadSounds","playRandomSound","playSound","getLeaderBoard","useFrameMultiplier","useTransactions","LeaderboardPopup","TransactionsTable","GameUI","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Game","_canvasRef$current2","_canvasRef$current3","canvasRef","explosions","enemies","playerTank","bullets","isDead","audioPool","hearts","buffs","killCountRef","totalScoreRef","countdownRef","isSoundOn","buffTimerRef","frameMultiplier","transactions","handleMint","handleTotalScore","imageCache","fire","player","imageCacheRef","assetsLoaded","setAssetsLoaded","gameState","setGameState","sounds","setSounds","soundBtnLabelOn","setSoundBtnLabelOn","countdownValue","setCountdownValue","buffTimerValue","setBuffTimerValue","isStartButtonDisabled","setIsStartButtonDisabled","gameStat","setGameStat","totalScore","killCount","fireMondalakKillKount","damageTaken","damageGiven","healsUsed","buffsTaken","isLeaderboardOpen","setIsLeaderboardOpen","updateGameStat","key","value","prev","explosionFrames","setExplosionFrames","isMobile","setIsMobile","bulletPoolRef","isUnsupportedBrowser","ua","navigator","userAgent","toLowerCase","includes","startCountdown","current","counter","countdownInterval","setInterval","clearInterval","startBuffTimer","number","isBuffed","buffCountDown","preloadImages","imageCacheEnemies","imageCacheFire","imageCachePlayer","loadImage","src","Promise","resolve","img","Image","onload","enemyImages","all","Object","entries","flatMap","_ref","srcList","map","index","enemyFireImages","_ref2","playerImages","_ref3","explosionFramesArr","Array","from","length","_","i","toggleSound","resetGameObjects","width","BULLET_SPEED","FIRE_RATE","forEach","audio","pause","currentTime","spawnEnemies","push","maxEnemiesAllowed","Math","min","MAX_ENEMIES_BEGINNING","floor","MAX_ENEMIES","enemiesToSpawn","spawnDelay","random","setTimeout","enemyType","difficulty","adjustedDifficulty","handleStopGame","mediaQuery","window","matchMedia","handleResize","event","matches","addEventListener","console","log","removeEventListener","then","document","body","style","overflow","catch","error","ctx","getContext","CANVAS_WIDTH","height","CANVAS_HEIGHT","keys","w","a","s","d","mouse","x","y","shooting","keyHandler","e","isKeyDown","getScale","rect","getBoundingClientRect","mouseMoveHandler","scale","clientX","left","clientY","top","killEnemy","enemy","enemyIndex","frame","splice","newKillCount","type","updateGameState","newX","newY","speed","max","updatePosition","dx","dy","angle","atan2","Date","now","lastShot","barrelEndX","cos","barrelSize","barrelEndY","sin","audioPoolNew","bullet","bulletSpeed","bulletColor","isPlayer","filter","isExpired","update","bulletIndex","sqrt","dead","takeDamage","damage","result","pool","heart","heartIndex","health","maxHealth","heal","expired","buff","buffIndex","updateAI","gameLoop","clearRect","fillStyle","fillRect","drawMap","MAP","CELL_SIZE","draw","drawBuff","explosion","drawImage","ceil","requestAnimationFrame","_canvasRef$current","className","children","textAlign","padding","margin","ref","isOpen","onClose","onSoundToggle","onStopGame","disabled","onClick","marginRight"],"sources":["/home/nick/Desktop/Monagaynanimas_Neynar/src/components/Game/Game.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { CONFIG } from '../../game/config.ts';\nimport { Mondalak } from '../../game/classes/Mondalak.ts';\nimport { Bullet } from '../../game/classes/Bullet.ts';\nimport { GameState } from '../../types.ts';\nimport { Enemy } from '../../game/classes/Enemy.ts';\nimport { Heart } from '../../game/classes/Heart.ts';\nimport { Buff } from '../../game/classes/Heart.ts';\nimport createEnemy from '../../game/createEnemy.ts';\nimport { loadSounds, playRandomSound, playSound, getLeaderBoard } from '../../game/utils.ts';\nimport { useFrameMultiplier } from '../../providers/FrameMultiplierProvider.tsx';\nimport { useTransactions } from '../../hooks/useTransactions.ts';\nimport LeaderboardPopup from '../LeaderboardPopup/LeaderboardPopup.tsx';\nimport TransactionsTable from '../TransactionsTable/TransactionsTable.tsx';\nimport GameUI from '../GameUI/GameUI.tsx';\n\nconst Game = () => {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const explosions = useRef<{ x: number; y: number; frame: number, width: number, height: number }[]>([]);\n  const enemies = useRef<Enemy[]>([]);\n  const playerTank = useRef<Mondalak | null>(null);\n  const bullets = useRef<Bullet[]>([]);\n  const isDead = useRef<boolean>(false);\n  const audioPool = useRef<HTMLAudioElement[]>([]);\n  const hearts = useRef<Heart[]>([]);\n  const buffs = useRef<Buff[]>([]);\n  const killCountRef = useRef<number>(0);\n  const totalScoreRef = useRef<number>(0);\n  const countdownRef = useRef<boolean>(false);\n  const isSoundOn = useRef<boolean>(true);\n  const buffTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const frameMultiplier = useFrameMultiplier(); \n  const { transactions, handleMint, handleTotalScore } = useTransactions();\n\n  type ImageCache = {\n    enemies: {\n      [key: string]: HTMLImageElement;\n    }\n    fire: {\n      [key: string]: HTMLImageElement;\n    }\n    player: {\n      [key: string]: HTMLImageElement;\n    };\n  };\n  \n  const imageCache = {\n    enemies: {},  \n    fire: {},\n    player: {}\n  } as ImageCache;\n\n  const imageCacheRef = useRef<ImageCache>({\n    enemies: {},\n    fire: {},\n    player: {},\n  });\n\n  const [assetsLoaded, setAssetsLoaded] = useState(false);\n  const [gameState, setGameState] = useState<GameState>('menu');\n  const [sounds, setSounds] = useState<{ [key: string]: HTMLAudioElement[] } | null>(null);\n  const [soundBtnLabelOn, setSoundBtnLabelOn] = useState(true)\n  const [countdownValue, setCountdownValue] = useState<number>(3);\n  const [buffTimerValue, setBuffTimerValue] = useState<number>(0);\n  const [isStartButtonDisabled, setIsStartButtonDisabled] = useState(true);\n  const [gameStat, setGameStat] = useState({\n    totalScore: 0,\n    killCount: 0,\n    fireMondalakKillKount: 0,\n    damageTaken: 0,\n    damageGiven: 0,\n    healsUsed: 0,\n    buffsTaken: 0\n  });\n\n  const [isLeaderboardOpen, setIsLeaderboardOpen] = useState(false);\n\n  const updateGameStat = (\n    key: keyof typeof gameStat,\n    value: number | ((prev: number) => number)\n  ) => {\n    setGameStat(prev => ({\n      ...prev,\n      [key]: typeof value === \"function\" ? (value as (prev: number) => number)(prev[key]) : value\n    }));\n  };\n\n  const [explosionFrames, setExplosionFrames] = useState<HTMLImageElement[]>([]);\n\n  const [isMobile, setIsMobile] = useState(false);\n\n  const bulletPoolRef = useRef<Bullet[]>([]);\n  \n  const isUnsupportedBrowser = () => {\n    const ua = navigator.userAgent.toLowerCase();\n    return (\n      (ua.includes(\"firefox\")) ||\n      (ua.includes(\"safari\") && !ua.includes(\"chrome\")) ||\n      (ua.includes(\"edg/\") && !ua.includes(\"chrome\")) ||  \n      ua.includes(\"tor\") \n    );\n  };\n\n  const startCountdown = () => {\n    setGameState('countdown');\n    countdownRef.current = true;\n    setCountdownValue(3);\n\n    let counter = 3;\n    const countdownInterval = setInterval(() => {\n      counter--;\n      setCountdownValue(counter);\n\n      if (counter <= 0) {\n        clearInterval(countdownInterval);\n        countdownRef.current = false;\n        setGameState('playing');\n      }\n    }, 1000);\n  };\n\n  const startBuffTimer = (number: number, playerTank: React.RefObject<{ isBuffed: boolean }>) => {\n    if (!playerTank.current || gameState !== \"playing\") return;\n\n    setBuffTimerValue(number);\n    playerTank.current.isBuffed = true;\n\n    if (buffTimerRef.current) {\n      clearInterval(buffTimerRef.current);\n    }\n\n    let counter = number;\n\n    const buffCountDown = setInterval(() => {\n      counter--;\n      setBuffTimerValue(counter);\n\n      if (counter <= 0) {\n        clearInterval(buffCountDown);\n        buffTimerRef.current = null;\n        if (playerTank.current) {\n          playerTank.current.isBuffed = false;\n        }\n      }\n    }, 1000);\n\n    buffTimerRef.current = buffCountDown;\n  };\n\n  const preloadImages = async () => {\n    const imageCacheEnemies = {\n      \"default\": [\n        \"/chars/10.svg\",\n        \"/chars/11.svg\",\n        \"/chars/12.svg\",\n        \"/chars/13.svg\",\n        \"/chars/14.svg\",\n      ],\n    };\n    const imageCacheFire = {\n      \"fire\": [\"/chars/8.svg\"]\n    };\n  \n    const imageCachePlayer = {\n      \"main\": [\"/chars/15.svg\"]\n    };\n  \n    const loadImage = (src: string) => {\n      return new Promise<HTMLImageElement>((resolve) => {\n        const img = new Image();\n        img.src = src;\n        img.onload = () => resolve(img);\n      });\n    };\n  \n    const enemyImages = await Promise.all(\n      Object.entries(imageCacheEnemies).flatMap(([key, srcList]) =>\n        srcList.map(async (src, index) => {\n          const img = await loadImage(src);\n          imageCache.enemies[index] = img;\n        })\n      )\n    );\n\n    const enemyFireImages = await Promise.all(\n      Object.entries(imageCacheFire).flatMap(([key, srcList]) =>\n        srcList.map(async (src, index) => {\n          const img = await loadImage(src);\n          imageCache.fire[index] = img;\n        })\n      )\n    );\n  \n    const playerImages = await Promise.all(\n      Object.entries(imageCachePlayer).flatMap(([key, srcList]) =>\n        srcList.map(async (src, index) => {\n          const img = await loadImage(src);\n          imageCache.player[index] =  img;\n        })\n      )\n    );\n  \n    const explosionFramesArr = await Promise.all(\n      Array.from({ length: 151 - 16 + 1 }, (_, i) => 16 + i).map(async (i) => {\n        const img = await loadImage(`/explotion/frame(${i}).png`);\n        return img;\n      })\n    );\n  \n    setExplosionFrames(explosionFramesArr);\n    imageCacheRef.current = imageCache;\n  };\n\n  const toggleSound = () => {\n    setSoundBtnLabelOn(!isSoundOn.current)\n    isSoundOn.current = !isSoundOn.current;\n  };\n\n  const resetGameObjects = () => {\n    playerTank.current = new Mondalak(\n      canvasRef.current!.width / 2,\n      canvasRef.current!.width / 2,\n      true,\n      CONFIG.BULLET_SPEED,\n      CONFIG.FIRE_RATE,\n      \"#c005c7\",\n      \"main\",\n      imageCacheRef.current.player[0]\n    );\n\n    bullets.current = [];\n    hearts.current = [];\n    buffs.current = [];\n    buffTimerRef.current = null;\n\n    updateGameStat(\"killCount\", 0);\n    updateGameStat(\"fireMondalakKillKount\", 0);\n    updateGameStat(\"damageTaken\", 0);\n    updateGameStat(\"damageGiven\", 0);\n    updateGameStat(\"totalScore\", 0);\n    updateGameStat(\"healsUsed\", 0);\n    updateGameStat(\"buffsTaken\", 0);\n\n    setBuffTimerValue(0);\n    killCountRef.current = 0;\n    totalScoreRef.current = 0;\n\n    isDead.current = false;\n    audioPool.current.forEach(audio => {\n      audio.pause();\n      audio.currentTime = 0;\n    });\n    audioPool.current = [];\n\n    if (gameState === \"countdown\") {\n      enemies.current = [];\n      spawnEnemies(0);\n    }\n\n    if (bulletPoolRef.current.length === 0) {\n      for (let i = 0; i < 50; i++) {\n        bulletPoolRef.current.push(new Bullet(0, 0, 0, 0, '', 0, false, 0, ''));\n      }\n    }\n  };\n\n  const spawnEnemies = (killCount) => {\n    if (!killCount) {\n      createEnemy(enemies.current, 1, true, \"default\", frameMultiplier, imageCacheRef.current);\n      return;\n    }\n\n    const maxEnemiesAllowed = Math.min(CONFIG.MAX_ENEMIES_BEGINNING + Math.floor(killCount / 10), CONFIG.MAX_ENEMIES);\n\n    if (enemies.current.length < maxEnemiesAllowed) {\n      const enemiesToSpawn = maxEnemiesAllowed - enemies.current.length;\n\n      for (let i = 0; i < enemiesToSpawn; i++) {\n        const spawnDelay = 150 + Math.random() * (430 - 150);\n        setTimeout(() => {\n          if (enemies.current.length < maxEnemiesAllowed) {\n            const enemyType = Math.random() < 0.05 ? \"fire\" : \"default\";\n            const difficulty = Math.min(Math.floor(killCount / 10), 10);\n            const adjustedDifficulty = enemyType === \"fire\" ? difficulty * 10 : difficulty;\n            enemies.current = createEnemy(enemies.current, adjustedDifficulty, false, enemyType, frameMultiplier, imageCacheRef.current);\n          }\n        }, spawnDelay);\n      }\n    }\n  };\n\n  const handleStopGame = () => {\n    const totalScore = totalScoreRef.current;\n    handleTotalScore(totalScore, true);\n    setGameState(\"menu\");\n    resetGameObjects();\n  }\n\n  useEffect(() => {\n    const mediaQuery = window.matchMedia(\"(max-width: 1100px)\");\n\n    const handleResize = (event: MediaQueryListEvent) => {\n      setIsMobile(event.matches);\n    };\n\n    setIsMobile(mediaQuery.matches);\n    mediaQuery.addEventListener(\"change\", handleResize);\n    console.log(frameMultiplier);\n    return () => mediaQuery.removeEventListener(\"change\", handleResize);\n  }, []);\n\n  useEffect(() => {\n      loadSounds().then(setSounds);\n      preloadImages().then(() => {\n        setAssetsLoaded(true);\n      });\n      \n      document.body.style.overflow = 'hidden';\n      \n      setTimeout(() => {\n        setIsStartButtonDisabled(false);\n        document.body.style.overflow = 'auto';\n      }, 1000);\n      \n      return () => {\n        document.body.style.overflow = 'auto';\n      };\n  }, []);\n\n  useEffect(() => {\n    if (gameState === 'playing' || gameState === 'menu') {\n      // Preload leaderboard data\n      getLeaderBoard().catch(error => console.error('Error getting leaderboard:', error));\n    }\n  }, [gameState]);\n\n  useEffect(() => {\n    if (gameState === \"playing\" || gameState === \"countdown\") {\n      if ( assetsLoaded ) {\n        resetGameObjects();\n      } else {\n        preloadImages().then(() => {\n          setAssetsLoaded(true);\n          resetGameObjects();\n        });\n      }\n\n    } else {\n      playerTank.current = null;\n      enemies.current = [];\n      bullets.current = [];\n    }\n\n  }, [gameState]);\n\n  useEffect(() => {\n    if (!canvasRef.current) return;\n    \n    const ctx = canvasRef.current.getContext('2d');\n    if (!ctx) return;\n\n    canvasRef.current.width = CONFIG.CANVAS_WIDTH;\n    canvasRef.current.height = CONFIG.CANVAS_HEIGHT;\n\n    const keys = { w: false, a: false, s: false, d: false };\n    const mouse = { x: 0, y: 0, shooting: false };\n\n    const keyHandler = (e: KeyboardEvent, isKeyDown: boolean) => {\n      switch (e.key.toLowerCase()) {\n        case 'w': case 'ц': keys.w = isKeyDown; break;\n        case 'a': case 'ф': keys.a = isKeyDown; break;\n        case 's': case 'ы': case \"і\": keys.s = isKeyDown; break;\n        case 'd': case 'в': keys.d = isKeyDown; break;\n      }\n    };\n\n    const getScale = () => {\n      const rect = canvasRef.current!.getBoundingClientRect();\n      return rect.width / CONFIG.CANVAS_WIDTH;\n    };\n\n    const mouseMoveHandler = (e: MouseEvent) => {\n      const scale = getScale();\n\n      const rect = canvasRef.current!.getBoundingClientRect();\n      mouse.x = (e.clientX - rect.left) / scale;\n      mouse.y = (e.clientY - rect.top) / scale;\n    };\n\n    const killEnemy = (enemy, enemyIndex) => {\n      explosions.current.push({ x: enemy.x, y: enemy.y, frame: 16, width: 100, height: 96 });\n      enemies.current.splice(enemyIndex, 1);\n\n      setGameStat(prev => {\n        const newKillCount = prev.killCount + 1;\n        killCountRef.current = newKillCount;\n        totalScoreRef.current = prev.totalScore + (enemy.type === \"fire\" ? 3 : 1);\n        spawnEnemies(newKillCount);\n        \n        return {\n          ...prev,\n          totalScore: prev.totalScore + (enemy.type === \"fire\" ? 3 : 1),\n          killCount: newKillCount,\n          fireMondalakKillKount: enemy.type === \"fire\" ? prev.fireMondalakKillKount + 1 : prev.fireMondalakKillKount\n        };\n      });\n\n      setTimeout(() => {\n        const totalScore = totalScoreRef.current;\n        handleTotalScore(totalScore, false);\n      }, 0);\n\n      // if (enemy.type === \"fire\") handleMint(killCountRef.current);\n\n      audioPool.current = playRandomSound(sounds, \"kill\", isSoundOn.current, audioPool.current);\n    };\n\n    const updateGameState = () => {\n      if (!playerTank.current || !canvasRef.current) return;\n\n      let newX = playerTank.current.x;\n      let newY = playerTank.current.y;\n\n      if (keys.w) newY -= playerTank.current.speed * frameMultiplier;\n      if (keys.s) newY += playerTank.current.speed * frameMultiplier;\n      if (keys.a) newX -= playerTank.current.speed * frameMultiplier;\n      if (keys.d) newX += playerTank.current.speed * frameMultiplier;\n\n      newX = Math.max(45, Math.min(canvasRef.current!.width - 45, newX));\n      newY = Math.max(45, Math.min(canvasRef.current!.height - 45, newY));\n\n      playerTank.current.updatePosition(newX, newY);\n\n      const dx = mouse.x - playerTank.current.x;\n      const dy = mouse.y - playerTank.current.y;\n      playerTank.current.angle = Math.atan2(dy, dx);\n\n      if (mouse.shooting && Date.now() - playerTank.current.lastShot > CONFIG.FIRE_RATE) {\n\n        const barrelEndX = playerTank.current.x + Math.cos(playerTank.current.angle) * playerTank.current.barrelSize;\n        const barrelEndY = playerTank.current.y + Math.sin(playerTank.current.angle) * playerTank.current.barrelSize;\n\n        const audioPoolNew: HTMLAudioElement[] = playSound(\"/sound/shoot/shooooot.mp3\", isSoundOn.current, audioPool.current);\n\n        audioPool.current = audioPoolNew;\n\n        const bullet = new Bullet(\n          barrelEndX,\n          barrelEndY,\n          playerTank.current.angle,\n          playerTank.current.bulletSpeed * frameMultiplier,\n          playerTank.current.bulletColor,\n          playerTank.current.isBuffed ? 18 : 7,\n          playerTank.current.isPlayer,\n          playerTank.current.isBuffed ? 2 : 1,\n          \"player\"\n        );\n        bullets.current.push(bullet);\n        playerTank.current.lastShot = Date.now();\n      }\n\n      bullets.current = bullets.current.filter(bullet => !bullet.isExpired);\n      bullets.current.forEach(bullet => bullet.update());\n\n      bullets.current.forEach((bullet, bulletIndex) => {\n        if (playerTank.current && !bullet.isExpired) {\n          const dx = playerTank.current.x - bullet.x;\n          const dy = playerTank.current.y - bullet.y;\n          if (Math.sqrt(dx * dx + dy * dy) < 35) {\n            const dead = playerTank.current.takeDamage(bullet.damage);\n\n            bullets.current.splice(bulletIndex, 1);\n            updateGameStat(\"damageTaken\", prev => prev + bullet.damage);\n            if (dead && !isDead.current) {\n              const totalScore = totalScoreRef.current;\n              handleTotalScore(totalScore, true);\n\n              isDead.current = true;\n              explosions.current.push({ x: playerTank.current.x, y: playerTank.current.y, frame: 16, width: 400, height: 395 });\n\n              playRandomSound(sounds, \"death\", isSoundOn.current, audioPool.current);\n\n              \n              setTimeout(() => {\n                setGameState(\"gameover\");\n              }, 1000);\n            } else {\n              const audioPoolNew: HTMLAudioElement[] = playSound(\"/sound/applepay.mp3\", isSoundOn.current, audioPool.current);\n              audioPool.current = audioPoolNew;\n            }\n          }\n        }\n\n        enemies.current.forEach((enemy, enemyIndex) => {\n          if (bullet.isPlayer) {\n            const dx = enemy.x - bullet.x;\n            const dy = enemy.y - bullet.y;\n            if (Math.sqrt(dx * dx + dy * dy) < (enemy.width / 2)) {\n              const result = enemy.takeDamage(bullet.damage);\n              bullets.current.splice(bulletIndex, 1);\n              updateGameStat(\"damageGiven\", prev => prev + bullet.damage);\n              \n              switch (result) {\n                case \"drop_heart\":\n                  hearts.current.push(new Heart(\n                    enemy.x,\n                    enemy.y\n                  ))\n\n                  killEnemy(enemy, enemyIndex);\n                  return;\n                case \"drop_buff\":\n                  buffs.current.push(new Buff(\n                    enemy.x,\n                    enemy.y\n                  ))\n\n                  killEnemy(enemy, enemyIndex);\n                  return;\n                case false:\n                  const pool = playRandomSound(sounds, \"hit\", isSoundOn.current, audioPool.current);\n                  audioPool.current = pool;\n                  return;\n              }\n            }\n          }\n        });\n\n      });\n      hearts.current.forEach((heart, heartIndex) => {\n        if (playerTank.current) {\n          const dx = playerTank.current.x - heart.x;\n          const dy = playerTank.current.y - heart.y;\n\n          if (Math.sqrt(dx * dx + dy * dy) < (playerTank.current.width / 2) && playerTank.current.health < playerTank.current.maxHealth) {\n            hearts.current.splice(heartIndex, 1);\n            const audioPoolNew: HTMLAudioElement[] = playSound(\"/sound/heal.mp3\", isSoundOn.current, audioPool.current);\n\n            audioPool.current = audioPoolNew;\n            playerTank.current.heal();\n            updateGameStat(\"healsUsed\", prev => prev + 1);\n\n          }\n\n          const expired = heart.isExpired();\n          if (expired) {\n            hearts.current.splice(heartIndex, 1);\n          }\n        }\n      })\n\n      buffs.current.forEach((buff, buffIndex) => {\n        if (playerTank.current) {\n          const dx = playerTank.current.x - buff.x;\n          const dy = playerTank.current.y - buff.y;\n\n          if (Math.sqrt(dx * dx + dy * dy) < (playerTank.current.width / 2)) {\n            buffs.current.splice(buffIndex, 1);\n            const audioPoolNew: HTMLAudioElement[] = playSound(\"/sound/heal.mp3\", isSoundOn.current, audioPool.current);\n\n            audioPool.current = audioPoolNew;\n            playerTank.current.isBuffed = true;\n            startBuffTimer(10, playerTank);\n            updateGameStat(\"buffsTaken\", prev => prev + 1);\n\n          }\n\n          const expired = buff.isExpired();\n          if (expired) {\n            buffs.current.splice(buffIndex, 1);\n          }\n        }\n      })\n\n      enemies.current.forEach(enemy => {\n        const bullet = enemy.updateAI(playerTank.current!.x, playerTank.current!.y);\n        if (bullet) {\n          bullets.current.push(bullet);\n        }\n      });\n   \n\n      if (killCountRef.current > 10) {\n        playerTank.current.maxHealth = 8\n      }\n    };\n\n    const gameLoop = () => {\n      if (!playerTank.current) return;\n      \n      ctx.clearRect(0, 0, CONFIG.CANVAS_WIDTH, CONFIG.CANVAS_HEIGHT);\n      ctx.fillStyle = '#ffccff';\n      ctx.fillRect(0, 0, CONFIG.CANVAS_WIDTH, CONFIG.CANVAS_HEIGHT);\n      \n      const drawMap = (ctx: CanvasRenderingContext2D) => {\n        ctx.fillStyle = '#800080';\n        for (let y = 0; y < CONFIG.MAP.length; y++) {\n          for (let x = 0; x < CONFIG.MAP[y].length; x++) {\n            if (CONFIG.MAP[y][x] === 1) {\n              ctx.fillRect(\n                x * CONFIG.CELL_SIZE,\n                y * CONFIG.CELL_SIZE,\n                CONFIG.CELL_SIZE - 1,\n                CONFIG.CELL_SIZE - 1\n              );\n            }\n          }\n        }\n      };\n\n      drawMap(ctx);\n\n      if (gameState === \"playing\") {\n        updateGameState();\n      }\n\n      playerTank.current.draw(ctx, isDead.current);\n\n      enemies.current.forEach(enemy => enemy.draw(ctx));\n\n      bullets.current.forEach(bullet => bullet.draw(ctx));\n\n      hearts.current.forEach(heart => heart.draw(ctx));\n      buffs.current.forEach(buff => buff.drawBuff(ctx));\n\n      explosions.current.forEach((explosion, index) => {\n        if (explosion.frame >= explosionFrames.length) {\n          explosions.current.splice(index, 1);\n          return;\n        }\n        ctx.drawImage(explosionFrames[explosion.frame], explosion.x - (explosion.width / 2) + (10 / 2),\n          explosion.y - (explosion.height / 2) + (20 / 2), explosion.height, explosion.height);\n        explosion.frame += Math.ceil(frameMultiplier);\n      });\n\n      \n    \n\n      requestAnimationFrame(gameLoop);\n    };\n\n    window.addEventListener('keydown', (e) => keyHandler(e, true));\n    window.addEventListener('keyup', (e) => keyHandler(e, false));\n    canvasRef.current.addEventListener('mousemove', mouseMoveHandler);\n    canvasRef.current.addEventListener('mousedown', () => mouse.shooting = true);\n    canvasRef.current.addEventListener('mouseup', () => mouse.shooting = false);\n\n    gameLoop();\n\n    return () => {\n      window.removeEventListener('keydown', (e) => keyHandler(e, true));\n      window.removeEventListener('keyup', (e) => keyHandler(e, false));\n      canvasRef.current?.removeEventListener('mousemove', mouseMoveHandler);\n    };\n  }, [gameState]);\n\n  if (isUnsupportedBrowser()) {\n    return (\n      <div className=\"bg-mobile bg\">\n        <div className=\"mobile-warning\">\n          <h2>Unsupported browser</h2>\n          <p>Please use browser from the list below.</p>\n          <ul style={{\n            textAlign: \"left\",\n            padding: 0,\n            margin: 0\n          }}>\n            <li>Chrome</li>\n            <li>Edge (Chrome based)</li>\n            <li>Safari (Chrome based)</li>\n          </ul>\n        </div>\n      </div>\n    );\n  }\n\n  if (isMobile) {\n    return (\n      <div className=\"bg-mobile bg\">\n        <div className=\"mobile-warning\">\n          <h2>Desktop version only</h2>\n          <p>Please use a larger screen to play the game.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"game-container\">\n      <div>\n        <canvas ref={canvasRef} width={canvasRef.current?.width} height={canvasRef.current?.height}></canvas>\n        {\n          gameState === \"countdown\" && (\n            <>\n              <div className=\"coundown bg\">\n                <h1>{countdownValue}</h1>\n              </div>\n            </>\n          )\n        }\n\n      <LeaderboardPopup \n        isOpen={isLeaderboardOpen} \n        onClose={() => setIsLeaderboardOpen(false)} \n      />\n\n        {gameState === 'playing' && (\n          <GameUI\n            killCount={gameStat.killCount}\n            buffTimerValue={buffTimerValue}\n            soundBtnLabelOn={soundBtnLabelOn}\n            onSoundToggle={toggleSound}\n            onStopGame={handleStopGame}\n          />\n        )}\n        {gameState === 'menu' && (\n          <>\n            <div className=\"bg\">\n              <h1 className='total-score h1'>Kill everyone <br /> Dodge everything</h1>\n                <button disabled={isStartButtonDisabled} className=\"leaderboard-button\" onClick={() => setIsLeaderboardOpen(true)}>\n                  Leaderboard\n                </button>\n\n              <div className=\"game-menu\">\n                <button disabled={isStartButtonDisabled} style={{\n                  marginRight: \"10px\"\n                }} onClick={toggleSound}>\n                  <span className=\"counter-label\">\n                    {\n                      soundBtnLabelOn ? \"Disable sounds\" : \"Enable sounds\"\n                    }\n                  </span>\n                </button>\n                <button onClick={startCountdown} disabled={isStartButtonDisabled}>\n                  {'Start'}\n                </button>\n              </div>\n            </div>\n\n          </>\n        )}\n\n        {gameState === 'gameover' && (\n          <>\n            <div className=\"bg\">\n              <h1 className='total-score h1'>Your total score: {gameStat.totalScore}</h1>\n              <button className=\"leaderboard-button\" onClick={() => setIsLeaderboardOpen(true)}>\n                  Leaderboard\n                </button>\n              <div className=\"game-menu\">\n\n                <button onClick={startCountdown}>\n                  {'Try again'}\n                </button>\n              </div>\n\n              <div className=\"game-stat\">\n\n                <div className=\"row\">\n                  <div className=\"col\">\n                    <span>Total kills: {gameStat.killCount}</span>\n                    <span>Bosses killed: {gameStat.fireMondalakKillKount}</span>\n                    <span>Damage dealt: {gameStat.damageGiven}</span>\n                  </div>\n                  <div className=\"col\">\n                    <span>Damage taken: {gameStat.damageTaken}</span>\n                    <span>Heals used: {gameStat.healsUsed}</span>\n                    <span>Buffs taken: {gameStat.buffsTaken}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </>\n\n        )}\n      </div>\n      <TransactionsTable transactions={transactions} />\n    </div>\n  );\n};\nexport default Game;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}